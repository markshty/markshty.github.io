<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>MenuButton --- Gtk::Popover</title>
    <link rel="stylesheet" href="stylesheet.css">
  </head>
  <body>
    <!-- タイトル -->
    <h1 class="title">MenuButton --- Gtk::Popover</h1>
    <p class="update">(update:2026/2/18)</p>
    <!-- 説明 -->
    <h2 class="ex1">概  要</h2>
    <h3 class="ex2">Gtk::MenuButtonとは</h3>
      <p class="paragraph">Gtk::MenuBar は、モダンな GTK4 アプリで「メニューを開くためのボタン」を提供するための重要なウィジェットで、従来の Gtk::Menu や Gtk::MenuBar よりも柔軟で、ポップオーバー中心のユーザーインターフェースの設計に適しています。</p>

    <h3 class="ex1">役　割</h3>
      <div class="paragraph">
        <p>Gtk::MenuButton は、クリックすると ポップオーバー（Gtk::Popover）を表示するためのボタンです。GTK4 では、従来の「プルダウンメニュー」よりも ポップオーバーとなるユーザーインターフェースが推奨されており、そのための標準的なエントリポイントが Gtk::MenuButton です。</p> 
        <br>   
      </div>

    <h3 class="ex1">機　能</h3>
      <div class="paragraph">
        <ol>
          <li>Gtk::Popover を簡単に紐づけ</li>       
            <p>set_popover() を使って、を使って、任意の Gtk::Popover を割り当てることができます。</p>
            <p><span class="emphasis6">void</span> <span class="emphasis">Gtk::MenuButton::set_popover(</span> <span class="emphasis2">Gtk:Popover&</span> <span class="emphasis4">popover</span> <span class="emphasis">)</span></p>
            <p>ポップオーバー内部には、Gtk::Box や Gtk::ListBox を自由に配置することができるため、柔軟なメニューのユーザインターフェースを構築することが可能です。</p>
            <br>
          <li>アイコンボタンとして使用する</li>
            <p>set_icon_name() を使えば、ハンバーガーメニューや設定アイコンなどを簡単に表示することができます。</p>
            <p><span class="emphasis6">void</span> <span class="emphasis">Gtk::MenuButton::set_icon_name(</span> <span class="emphasis2">const Glib:ustring&</span> <span class="emphasis4">icon_name</span> <span class="emphasis">)</span></p>
            <br>
          <li>Gio::Menuと連携できる</li>
            <p>set_menu_model() を使うと、Gio::Menuベースの宣言的メニューを割り当てることができます。</p>
            <p><span class="emphasis6">void</span> <span class="emphasis">Gtk::MenuButton::set_menu_model(</span> <span class="emphasis2">const Glib:RefPtr&lt;const Gio::MenuModel&gt;&</span> <span class="emphasis4">menu_model</span> <span class="emphasis">)</span></p>
            <br>
          <li>ポップオーバーの位置や挙動を制御可能</li>
            <p>set_direction()により、ポップオーバーの表示方向を指定することができます。</p>
            <p><span class="emphasis6">void</span> <span class="emphasis">Gtk::MenuButton::set_direction(</span> <span class="emphasis2">Gtk::ArrowType</span> <span class="emphasis4">direction</span> <span class="emphasis">)</span></p>
            <table width="60%" border="0" cellspacong="1" bgcolor="#000000">
              <tr>
                <th class="table_heading" colspan="2">Gtk::ArrowType</th>
              </tr>
              <tr>
                <th width="15%" class="table_heading">記　号</th>
                <th width="40%" class="table_heading">内　容</th>
              </tr>
              <tr>
                <td width="15%" class="table_cell">UP</td>
                <td width="40%" class="table_cell">上向きの矢印を表す</td>
              </tr>
              <tr>
                <td width="15%" class="table_cell">DOWN</td>
                <td width="40%" class="table_cell">下向きの矢印を表す</td>      
              </tr>
              <tr>
                <td width="15%" class="table_cell">LEFT</td>
                <td width="40%" class="table_cell">左向きの矢印を表す</td>
              </tr>
              <tr>
                <td width="15%" class="table_cell">RIGHT</td>
                <td width="40%" class="table_cell">下向きの矢印を表す</td>
              </tr>
              <tr>
                <td width="15%" class="table_cell">NONE</td>
                <td width="40%" class="table_cell">矢印無し</td>
              </tr>
            </table>
            <br>
        </ol>
        <br>
      </div>

    <!-- Sample C++ Program -->
    <a id="SampleProgram1"/>
    <h2 class="ex21">サンプル プログラム</h2>
    <h3 class="ex1">考え方</h3>
      <div class="paragraph">
        <p>Gtk::Popover にメニューの内容を登録し、その後、Gtk::Popover を Gtk::MenuButton に結びつけます。</p>
      </div>

    <h3 class="ex1">構　成</h3>
      <div class="paragraph">
        <ol>
          <li>child widget の宣言</li>
            <p>Gtk::MenuButton、Gtk::Popover を宣言します。</li>
            </ul>
          <li>Gtk::MenuButton の設定</li>
            <ul class="ul1">
              <li>アイコンのセット</li>
                <p>set_icon_name() を用いて Gtk::MenuButton に表示するアイコンをセットします。</p>
              <li>Gtk::HeaderBar に Gtk::MenuButton をセット</li>
                <p>Gtk::HeaderBar の右側に Gtk::MenuButton をセットします。</p>
            </ul>
          <li>Gtk::Popover の設定</li>
            <ul class="ul1">
              <li>Gtk::Box と Gtk::Button の領域を確保</li>
                <p>Gtk::Box を縦書きで領域を確保します。そして、 Gtk::Button の領域を確保します。</p>
              <li>Gtk::Button のイベントシグナルとシグナルハンドラーを接続</li>
                <p>Gtk::Button のイベントシグナル(signal_click) が発生した際に、標準出力(std::cout)に "Action clicked" となるメッセージを表示します。</p>
              <li>Gtk::Box に Gtk::Button を格納</li>
                <p>Gtk::Box に Gtk::Button を apeend() メソッドで格納します。</p>
              <li>Gtk::Popover に Gtk::Box をセット</li>
                <p>Gtk::Popover に Gtk::Box を子ウィジットとしてセットします。
            </ul>
          <li>Gtk::MenuButton に Gtk::Popoverを紐づけ</li>
            <p>set_popover() メソッドを用いて、Gtk::MenuButton に Gtk::Popover をセットします。</p>
        </ol>
      </div>

      <div id="pagebody">
        <pre><code class="language-c++">
#include &lt;gtkmm.h&gt;
#include &lt;iostream&gt;

class MyWindow : public Gtk::Window
{
public:
    MyWindow();
    virtual ~MyWindow() = default;

private:
   // <span class="emphasis3">1.child widget の宣言</span>
    Gtk::HeaderBar headerbar;
    Gtk::Label title_label{ "MenuButton" };
    <span class="emphasis3">// 1.1 Gtk::MenuButtonの宣言</span>
    <span class="emphasis">Gtk::MenuButton menu_button</span>;
    <span class="emphasis3">// 1.2 Gtk::Popoverの宣言</span>
    <span class="highlight">Gtk::Popover popover</span>;
};

MyWindow::MyWindow()
{
    set_title( "MenuButton" );
    set_default_size( 320, 240 );

   // HeaderBar
    headerbar.set_title_widget( title_label );
    set_titlebar( headerbar );

   // <span class="emphasis3">2.Gtk::MenuButton の設定</span>
    <span class="emphasis3">// 2.1 アイコンのセット</span>
    menu_button.<span class="emphasis">set_icon_name(</span> "open-menu-symbolic" <span class="emphasis">)</span>;
    <span class="emphasis3">// 2.2 Gtk::HeaderBar に Gtk::MenuButton をセット</span>
    <span class="highlight">headerbar.pack_end(</span> menu_button <span class="emphasis4">)</span>;

   // <span class="emphasis3">3.Gtk::Popover の設定</span>
    // 3.1 Gtk::Box と Gtk::Button の領域を確保
    auto box = Gtk::make_managed&lt;Gtk::Box&gt;( Gtk::Orientation::VERTICAL, 6 );
    auto btn1 = Gtk::make_managed&lt;Gtk::Button&gt;( "Action 1" );
    auto btn2 = Gtk::make_managed&lt;Gtk::Button&gt;( "Action 2" );
    auto btn3 = Gtk::make_managed&lt;Gtk::Button&gt;( "Action 3" );

    // 3.2 Gtk::Button のイベントシグナルとシグナルハンドラーを接続
    btn1->signal_clicked().connect([] {
        std::cout &lt;&lt; "Action 1 clicked\n";
    });
    btn2->signal_clicked().connect([] {
        std::cout &lt;&lt; "Action 2 clicked\n";
    });
    btn3->signal_clicked().connect([] {
        std::cout &lt;&lt; "Action 3 clicked\n";
    });

    // 3.3 Gtk::Box に Gtk::Button を格納
    box->append( *btn1 );
    box->append( *btn2 );
    box->append( *btn3 );

    // 3.4 Gtk::Popover に Gtk::Box をセット
    popover.set_child( *box );

    <span class="emphasis3">// 4.Gtk::MenuButton に Gtk::Popoverを紐づけ</span>
    menu_button.<span class="emphasis">set_popover(</span> popover <span class="emphasis">)</span>;
}

int main( int argc, char* argv[] )
{
    auto app = Gtk::Application::create( "menubutton.example1" );
    return app->make_window_and_run&lt;MyWindow&gt;( argc, argv );
}
        </code></pre>
      </div>
    <br>
    <!-- 実行結果 -->
    <h2 class="ex3">実行結果</h2>
    <div class="result-table">
      <table width="65%" border="0" cellspacong="1" bgcolor="#23ff91" align="center">
        <tr>
          <th bgcolor="#23ff91" colspan="2"><font color="#ffffff">Gtk::Popoverで紐づけ</font></th>
        </tr>
        <tr>
          <td width="30%" class="table_heading">Console</td>
          <td width="30%" class="table_heading">Window</td>
        </tr>
        <tr>
          <td width="30%" class="terminal_cell">
          $ ./test &<br>
          $ Action 1 clicked<br>
          $ Action 2 clicked<br>
          $ Action 3 clicked<br>
          $ 
          </td>
          <td width="30%" class="table_heading"><img src="./images/button-menubutton1.png"></td>
        </tr>
      </table>
    </div>
    <hr>

    <!-- フッター -->
    <div class="navifooter">
      <table width="100%" summary="Navigation footer">
        <tr>
          <td width="40%" align="center"><a href="button-spin.html">Previous</a></td>
          <td width="20%" align="center"><a href="../index.html">Top</a></td>
          <td width="40%" align="center"><a href="button-menubutton2.html">Next</a></td>
        </tr>
      </table>
    </div>
    <hr>

    <div class="footer">
      <table width="100%" summary="footer">
        <tr>
          <th bgcolor="#23ff91"><font color="#ffffff">Copyright (c) Henrry Yamm Project All Rights Reserved.</font></th>
        </tr> 
      </table>
    </div>
  </body>
</html>
